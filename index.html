<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interaktive Europa-Karte</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <style>
    html, body {
      height: 100%;
      margin: 0;
    }
    #map {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>

  <div id="map"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    // Karte starten (Europa-Zentriert)
    const map = L.map('map').setView([51.1657, 10.4515], 5);

    // Hintergrundkarte (OpenStreetMap)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; <a href="https://openstreetmap.org">OpenStreetMap</a>'
    }).addTo(map);

    // Farbskala je nach Preis
    function getColor(preis) {
      return preis > 400 ? '#800026' :
             preis > 300 ? '#BD0026' :
             preis > 200 ? '#E31A1C' :
             preis > 100 ? '#FC4E2A' :
             preis > 50  ? '#FD8D3C' :
             preis > 20  ? '#FEB24C' :
             preis > 0   ? '#FED976' :
                           '#FFEDA0';
    }

    // Beispielhafte Preisdaten (du kannst sie später anpassen)
    const preise = {
      "Bayern": 350,
      "Sachsen": 280,
      "Nordrhein-Westfalen": 230,
      "Berlin": 300,
      "Frankreich": 310,
      "Polen": 180,
      "Österreich": 270
    };

    // Bundesländer und Nachbarländer laden (aus GitHub-Rohdaten)
    const geoUrl = "https://raw.githubusercontent.com/isellsoap/deutschlandGeoJSON/main/2_bundeslaender/4_niedrig.geo.json";
    const europeUrl = "https://raw.githubusercontent.com/martynafford/natural-earth-geojson/master/10m_cultural/ne_10m_admin_0_countries.geojson";

    // Erst Deutschland zeichnen
    fetch(geoUrl)
      .then(res => res.json())
      .then(data => {
        L.geoJSON(data, {
          style: feature => ({
            color: "#555",
            weight: 1,
            fillColor: getColor(preise[feature.properties.NAME_1] || 0),
            fillOpacity: 0.6
          }),
          onEachFeature: (feature, layer) => {
            const name = feature.properties.NAME_1;
            const preis = preise[name] ? preise[name] + " € / t" : "keine Daten";
            layer.bindTooltip(`<b>${name}</b><br>Preis: ${preis}`, { sticky: true });
          }
        }).addTo(map);
      });

    // Dann Nachbarländer hinzufügen
    fetch(europeUrl)
      .then(res => res.json())
      .then(data => {
        L.geoJSON(data, {
          style: feature => ({
            color: "#666",
            weight: 0.8,
            fillColor: getColor(preise[feature.properties.ADMIN] || 0),
            fillOpacity: 0.4
          }),
          onEachFeature: (feature, layer) => {
            const name = feature.properties.ADMIN;
            const preis = preise[name] ? preise[name] + " € / t" : "keine Daten";
            layer.bindTooltip(`<b>${name}</b><br>Preis: ${preis}`, { sticky: true });
          }
        }).addTo(map);
      });
  </script>

</body>
</html>
